services:
- type: web
  name: fimbot
  env: python
  region: singapore
  buildCommand: |
    # Install Python and set up environment
    apt-get update && apt-get install -y python3 python3-pip python3-venv
    python3 -m venv /opt/venv
    . /opt/venv/bin/activate
    # Upgrade pip and install dependencies
    pip install --upgrade pip
    pip install -r requirements.txt
  startCommand: |
    . /opt/venv/bin/activate
    gunicorn bot_logic:app --workers 4 --threads 2 --timeout 120 --bind 0.0.0.0:$PORT
  envVars:
    - key: PYTHON_VERSION
      value: 3.10.2
    - key: PYTHONPATH
      value: /opt/venv/lib/python3.8/site-packages
    - key: PATH
      value: /opt/venv/bin:/usr/local/bin:/usr/bin:$PATH
    - key: DEBIAN_FRONTEND
      value: noninteractive
  healthCheckPath: /health
  autoDeploy: true

